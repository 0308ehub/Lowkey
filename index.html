<!DOCTYPE html>
<head
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>Login / Sign Up Form</title>
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./src/main.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>

    <script>
        // Initialize Firebase with your project's config
        var firebaseConfig = {
            apiKey: "AIzaSyCxVVcoDCf1xUAkijjE-SJ0sT6gIPlm0y8",
            authDomain: "lowkey-365f7.firebaseapp.com",
            projectId: "lowkey-365f7",
            storageBucket: "lowkey-365f7.appspot.com",
            messagingSenderId: "1035139135538",
            appId: "1:1035139135538:web:e400ee2968b508fa7a642b",
            measurementId: "G-MX66ZYGEKX"
        };
        firebase.initializeApp(firebaseConfig);
    </script>

    <script>
        // Function to check if a user is logged in or not
        function checkAuthState() {
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
            // User is signed in, proceed to the website
            window.location.href = "homepage.html";
            } else {
            // No user is signed in, stay on the login page
            }
        });
        }

        // Function to handle the login form submission
        function login() {
        var email = document.getElementById("email").value;
        var password = document.getElementById("password").value;

        firebase.auth().signInWithEmailAndPassword(email, password)
            .then(function() {
            // Login successful, redirect to the homepage
            window.location.href = "homepage.html";
            })
            .catch(function(error) {
            // Handle errors here
            var errorCode = error.code;
            var errorMessage = error.message;
            console.log("Login error:", errorCode, errorMessage);
            });
        }
    </script>
</head>
<body onload="checkAuthState()">
    <div class="container">
        <form class="form" id="login">
            <h1 class="form__title">Login</h1>
            <div class="form__message form__message--error"></div>
            <div class="form__input-group">
                <input type="text" id="email" class="form__input" autofocus placeholder="Username or email">
                <div class="form__input-error-message"></div>
            </div>
            <div class="form__input-group">
                <input type="password" id="password" class="form__input" autofocus placeholder="Password">
                <div class="form__input-error-message"></div>
            </div>
            <button class="form__button" type="submit" onclick="login()">Continue</button>
            <p class="form__text">
                <a href="#" class="form__link">Forgot your password?</a>
            </p>
            <p class="form__text">
                <a class="form__link" href="./" id="linkCreateAccount">Don't have an account? Create account</a>
            </p>
        </form>
        <form class="form form--hidden" id="createAccount">
            <h1 class="form__title">Create Account</h1>
            <div class="form__message form__message--error"></div>
            <div class="form__input-group">
                <input type="text" id="signupUsername" class="form__input" autofocus placeholder="Username">
                <div class="form__input-error-message"></div>
            </div>
            <div class="form__input-group">
                <input type="text" class="form__input" autofocus placeholder="Email Address">
                <div class="form__input-error-message"></div>
            </div>
            <div class="form__input-group">
                <input type="password" class="form__input" autofocus placeholder="Password">
                <div class="form__input-error-message"></div>
            </div>
            <div class="form__input-group">
                <input type="password" class="form__input" autofocus placeholder="Confirm password">
                <div class="form__input-error-message"></div>
            </div>
            <button class="form__button" type="submit">Continue</button>
            <p class="form__text">
                <a class="form__link" href="./" id="linkLogin">Already have an account? Sign in</a>
            </p>
        </form>
    </div>
    <script src="./src/main.js"></script>
</body>